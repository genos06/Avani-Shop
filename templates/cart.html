{% include "header.html" %}
    <!-- ##### Breadcrumb Area Start ##### -->
    <div class="breadcrumb-area">
        <!-- Top Breadcrumb Area -->
        <div class="top-breadcrumb-area bg-img bg-overlay d-flex align-items-center justify-content-center" style="background-image: url('{{ url_for('static', filename='img/bg-img/24.jpg') }}');">
            <h2>Cart</h2>
        </div>

        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{{ url_for('home') }}"><i class="fa fa-home"></i> Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Cart</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </div>
    <!-- ##### Breadcrumb Area End ##### -->

    <!-- ##### Cart Area Start ##### -->
    <div class="cart-area section-padding-0-100 clearfix">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    {% if cart_items %}
                    <div class="cart-table clearfix">
                        <table class="table table-responsive">
                            <thead>
                                <tr>
                                    <th>Products</th>
                                    <th>Quantity (kg)</th>
                                    <th>Price</th>
                                    <th>TOTAL</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in cart_items %}
                                <tr>
                                    <td class="cart_product_img">
                                        <a href="{{ url_for('shop_details', product_id=item.product.id) }}"><img src="{{ url_for('static', filename=item.product.image_filename) }}" alt="{{ item.product.name }}"></a>
                                        <h5>{{ item.product.name }}</h5>
                                    </td>
                                    <td class="qty">
                                        <div class="quantity">
                                            <form action="{{ url_for('update_cart', product_id=item.product.id) }}" method="post" style="display: inline;">
                                                <span class="qty-minus" onclick="document.getElementById('qty{{ item.product.id }}').stepDown(); this.closest('form').submit();"><i class="fa fa-minus" aria-hidden="true"></i></span>
                                                <input type="number" class="qty-text" id="qty{{ item.product.id }}" step="1" min="1" max="{{ item.product.stock }}" name="quantity" value="{{ item.quantity }}" onchange="this.form.submit()">
                                                <span class="qty-plus" onclick="document.getElementById('qty{{ item.product.id }}').stepUp(); this.closest('form').submit();"><i class="fa fa-plus" aria-hidden="true"></i></span>
                                            </form>
                                        </div>
                                    </td>
                                    <td class="price"><span>₹{{ "%.2f"|format(item.product.price) }}</span></td>
                                    <td class="total_price"><span>₹{{ "%.2f"|format(item.subtotal) }}</span></td>
                                    <td class="action"><a href="{{ url_for('remove_from_cart', product_id=item.product.id) }}"><i class="icon_close"></i></a></td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="alert alert-info text-center">
                        <h4>Your cart is empty</h4>
                        <p>Browse our shop and add items to your cart!</p>
                        <a href="{{ url_for('shop') }}" class="btn alazea-btn mt-3">Go to Shop</a>
                    </div>
                    {% endif %}
                </div>
            </div>

            {% if cart_items %}
            <div class="row">

                <!-- Coupon Discount -->
                <div class="col-12 col-lg-6">
                    <div class="coupon-discount mt-70">
                        <h5>COUPON DISCOUNT</h5>
                        <p>Coupons can be applied in the cart prior to checkout. Add an eligible item from the booth of the seller that created the coupon code to your cart. Click the green "Apply code" button to add the coupon to your order. The order total will update to indicate the savings specific to the coupon code entered.</p>
                        <form action="#" method="post">
                            <input type="text" name="coupon-code" placeholder="Enter your coupon code">
                            <button type="submit">APPLY COUPON</button>
                        </form>
                    </div>
                </div>

                <!-- Cart Totals -->
                <div class="col-12 col-lg-6">
                    <div class="cart-totals-area mt-70">
                        <h5 class="title--">Order Summary</h5>
                        
                        <!-- Product List -->
                        <div class="order-products mb-4">
                            {% for item in cart_items %}
                            <div class="single-product-summary d-flex justify-content-between align-items-center mb-3 pb-2" style="border-bottom: 1px solid #ebebeb;">
                                <div class="product-info">
                                    <p class="mb-1"><strong>{{ item.product.name }}</strong></p>
                                    <p class="text-muted mb-2" style="font-size: 14px;">Qty: {{ item.quantity }} kg × ₹{{ "%.2f"|format(item.product.price) }}</p>
                                </div>
                                <div class="product-total">
                                    <h6 class="mb-0">₹{{ "%.2f"|format(item.subtotal) }}</h6>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <!-- Subtotal -->
                        <div class="subtotal d-flex justify-content-between mb-3 pb-3" style="border-bottom: 2px solid #ebebeb;">
                            <h5>Subtotal</h5>
                            <h5>₹{{ "%.2f"|format(total) }}</h5>
                        </div>
                        
                        <!-- Total -->
                        <div class="total d-flex justify-content-between mb-4">
                            <h5>Total</h5>
                            <h5>₹{{ "%.2f"|format(total) }}</h5>
                        </div>
                        
                        <!-- Buttons -->
                        <div class="checkout-btn">
                            <a href="{{ url_for('checkout') }}" class="btn alazea-btn w-100">PROCEED TO CHECKOUT</a>
                        </div>
                        <div class="mt-3">
                            <a href="{{ url_for('clear_cart') }}" class="btn btn-outline-danger w-100">Clear Cart</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

        </div>
    </div>
    <!-- ##### Cart Area End ##### -->


    <style>
        /* Remove spinner arrows from number input */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        input[type=number] {
            -moz-appearance: textfield;
            appearance: textfield;
        }
    </style>

{% include "footer.html" %}
